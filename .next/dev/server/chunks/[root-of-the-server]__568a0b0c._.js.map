{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/muhammedanshifp/Documents/kiswastore/admin/lib/mongodb.ts"],"sourcesContent":["import mongoose from 'mongoose';\n\nconst MONGODB_URI = process.env.MONGODB_URI || 'mongodb://localhost:27017/kiswastore';\n\nif (!MONGODB_URI) {\n    throw new Error('Please define the MONGODB_URI environment variable inside .env.local');\n}\n\ninterface MongooseCache {\n    conn: typeof mongoose | null;\n    promise: Promise<typeof mongoose> | null;\n}\n\ndeclare global {\n    var mongoose: MongooseCache;\n}\n\nlet cached = global.mongoose;\n\nif (!cached) {\n    cached = global.mongoose = { conn: null, promise: null };\n}\n\nasync function dbConnect() {\n    if (cached.conn) {\n        return cached.conn;\n    }\n\n    if (!cached.promise) {\n        const opts = {\n            bufferCommands: false,\n        };\n\n        cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n            return mongoose;\n        });\n    }\n\n    try {\n        cached.conn = await cached.promise;\n    } catch (e) {\n        cached.promise = null;\n        throw e;\n    }\n\n    return cached.conn;\n}\n\nexport default dbConnect;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAE/C;;AAaA,IAAI,SAAS,OAAO,QAAQ;AAE5B,IAAI,CAAC,QAAQ;IACT,SAAS,OAAO,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AAC3D;AAEA,eAAe;IACX,IAAI,OAAO,IAAI,EAAE;QACb,OAAO,OAAO,IAAI;IACtB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACjB,MAAM,OAAO;YACT,gBAAgB;QACpB;QAEA,OAAO,OAAO,GAAG,mKAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACvD,OAAO;QACX;IACJ;IAEA,IAAI;QACA,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACtC,EAAE,OAAO,GAAG;QACR,OAAO,OAAO,GAAG;QACjB,MAAM;IACV;IAEA,OAAO,OAAO,IAAI;AACtB;uCAEe"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///Users/muhammedanshifp/Documents/kiswastore/admin/models/Company.ts"],"sourcesContent":["import mongoose, { Schema, Document, Model } from 'mongoose';\n\nexport interface ICompany extends Document {\n    name: string;\n    industry: string;\n    location: string;\n    valuation: string;\n    status: 'prospect' | 'mql' | 'sql' | 'won' | 'lost';\n    stage: 'Lead' | 'MQL' | 'MAL' | 'SAL' | 'Deal Won' | 'Repeat Client';\n\n    // Multiple Contacts/Employees\n    contacts: {\n        name: string;\n        role: string;\n        email: string;\n        phone: string;\n    }[];\n\n    // Additional Fields\n    notes: string[];\n    emailHistory: {\n        subject: string;\n        date: Date;\n        body: string;\n    }[];\n    links: string[];\n    previousOrders: mongoose.Types.ObjectId[];\n\n    logo?: string;\n    assignedEmployee?: mongoose.Types.ObjectId;\n}\n\nconst CompanySchema = new Schema<ICompany>({\n    name: { type: String, required: true },\n    industry: String,\n    location: String,\n    valuation: String,\n    status: { type: String, enum: ['prospect', 'mql', 'sql', 'won', 'lost'], default: 'prospect' },\n    stage: { type: String, enum: ['Lead', 'MQL', 'MAL', 'SAL', 'Deal Won', 'Repeat Client'], default: 'Lead' },\n\n    contacts: [{\n        name: String,\n        role: String,\n        email: String,\n        phone: String\n    }],\n\n    notes: [{ type: String }],\n    emailHistory: [{\n        subject: String,\n        date: { type: Date, default: Date.now },\n        body: String\n    }],\n    links: [{ type: String }],\n    previousOrders: [{ type: Schema.Types.ObjectId, ref: 'Order' }],\n\n    logo: String,\n    assignedEmployee: { type: Schema.Types.ObjectId, ref: 'Employee' }\n}, { timestamps: true });\n\nconst Company: Model<ICompany> = mongoose.models.Company || mongoose.model<ICompany>('Company', CompanySchema);\nexport default Company;\n"],"names":[],"mappings":";;;;AAAA;;AAgCA,MAAM,gBAAgB,IAAI,kKAAM,CAAW;IACvC,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAK;IACrC,UAAU;IACV,UAAU;IACV,WAAW;IACX,QAAQ;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAY;YAAO;YAAO;YAAO;SAAO;QAAE,SAAS;IAAW;IAC7F,OAAO;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAQ;YAAO;YAAO;YAAO;YAAY;SAAgB;QAAE,SAAS;IAAO;IAEzG,UAAU;QAAC;YACP,MAAM;YACN,MAAM;YACN,OAAO;YACP,OAAO;QACX;KAAE;IAEF,OAAO;QAAC;YAAE,MAAM;QAAO;KAAE;IACzB,cAAc;QAAC;YACX,SAAS;YACT,MAAM;gBAAE,MAAM;gBAAM,SAAS,KAAK,GAAG;YAAC;YACtC,MAAM;QACV;KAAE;IACF,OAAO;QAAC;YAAE,MAAM;QAAO;KAAE;IACzB,gBAAgB;QAAC;YAAE,MAAM,kKAAM,CAAC,KAAK,CAAC,QAAQ;YAAE,KAAK;QAAQ;KAAE;IAE/D,MAAM;IACN,kBAAkB;QAAE,MAAM,kKAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAW;AACrE,GAAG;IAAE,YAAY;AAAK;AAEtB,MAAM,UAA2B,mKAAQ,CAAC,MAAM,CAAC,OAAO,IAAI,mKAAQ,CAAC,KAAK,CAAW,WAAW;uCACjF"}},
    {"offset": {"line": 172, "column": 0}, "map": {"version":3,"sources":["file:///Users/muhammedanshifp/Documents/kiswastore/admin/app/api/crm/companies/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport dbConnect from '@/lib/mongodb';\nimport Company from '@/models/Company';\n\nexport async function GET(request: NextRequest, { params }: { params: Promise<{ id: string }> }) {\n    try {\n        await dbConnect();\n        const { id } = await params;\n        const company = await Company.findById(id)\n            .populate('previousOrders')\n            .populate('assignedEmployee');\n        if (!company) {\n            return NextResponse.json({ error: 'Company not found' }, { status: 404 });\n        }\n        return NextResponse.json(company);\n    } catch (error) {\n        return NextResponse.json({ error: 'Failed to fetch company' }, { status: 500 });\n    }\n}\n\nexport async function PUT(request: NextRequest, { params }: { params: Promise<{ id: string }> }) {\n    try {\n        await dbConnect();\n        const { id } = await params;\n        const body = await request.json();\n        const company = await Company.findByIdAndUpdate(id, body, { new: true });\n        return NextResponse.json(company);\n    } catch (error) {\n        return NextResponse.json({ error: 'Failed to update company' }, { status: 500 });\n    }\n}\n\nexport async function DELETE(request: NextRequest, { params }: { params: Promise<{ id: string }> }) {\n    try {\n        await dbConnect();\n        const { id } = await params;\n        await Company.findByIdAndDelete(id);\n        return NextResponse.json({ message: 'Company deleted' });\n    } catch (error) {\n        return NextResponse.json({ error: 'Failed to delete company' }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAoB,EAAE,EAAE,MAAM,EAAuC;IAC3F,IAAI;QACA,MAAM,IAAA,2HAAS;QACf,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QACrB,MAAM,UAAU,MAAM,8HAAO,CAAC,QAAQ,CAAC,IAClC,QAAQ,CAAC,kBACT,QAAQ,CAAC;QACd,IAAI,CAAC,SAAS;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAoB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACJ;AAEO,eAAe,IAAI,OAAoB,EAAE,EAAE,MAAM,EAAuC;IAC3F,IAAI;QACA,MAAM,IAAA,2HAAS;QACf,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QACrB,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,UAAU,MAAM,8HAAO,CAAC,iBAAiB,CAAC,IAAI,MAAM;YAAE,KAAK;QAAK;QACtE,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAClF;AACJ;AAEO,eAAe,OAAO,OAAoB,EAAE,EAAE,MAAM,EAAuC;IAC9F,IAAI;QACA,MAAM,IAAA,2HAAS;QACf,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QACrB,MAAM,8HAAO,CAAC,iBAAiB,CAAC;QAChC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAkB;IAC1D,EAAE,OAAO,OAAO;QACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAClF;AACJ"}}]
}