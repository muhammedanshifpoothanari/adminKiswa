module.exports=[15468,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(40695),e=a.i(3130),f=a.i(88237),g=a.i(65733),h=a.i(5522),i=a.i(17171),j=a.i(87682),k=a.i(54161),l=a.i(46893),m=a.i(77156),n=a.i(15618),o=a.i(33508);function p(){let[a,p]=(0,c.useState)([]),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)({customerId:"",items:[{productId:"",name:"",quantity:1,price:0}],shippingAddress:{street:"",city:"",country:""},notes:"",status:"pending",paymentStatus:"pending"});async function C(){let a=await fetch("/api/orders");a.ok&&p(await a.json())}async function D(){let a=await fetch("/api/customers");a.ok&&r(await a.json())}async function E(){let a=await fetch("/api/products");a.ok&&t(await a.json())}async function F(a){a.preventDefault();let b=A.items.map(a=>({product:a.productId,name:a.name,quantity:a.quantity,price:a.price,total:a.quantity*a.price})),c=b.reduce((a,b)=>a+b.total,0),d={orderNumber:`ORD-${Date.now()}`,customer:A.customerId||null,items:b,subtotal:c,tax:0,shippingCost:0,total:c,status:A.status,paymentStatus:A.paymentStatus,shippingAddress:A.shippingAddress,notes:A.notes};(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).ok&&(v(!1),B({customerId:"",items:[{productId:"",name:"",quantity:1,price:0}],shippingAddress:{street:"",city:"",country:""},notes:"",status:"pending",paymentStatus:"pending"}),C())}function G(a,b,c){let d=[...A.items];if(d[a][b]=c,"productId"===b){let b=s.find(a=>a._id===c);b&&(d[a].name=b.name,d[a].price=b.price)}B({...A,items:d})}return(0,c.useEffect)(()=>{C(),D(),E()},[]),(0,b.jsxs)("div",{className:"p-8 space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Orders"}),(0,b.jsxs)(g.Dialog,{open:u,onOpenChange:v,children:[(0,b.jsx)(g.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(d.Button,{children:[(0,b.jsx)(n.Plus,{className:"mr-2 h-4 w-4"})," Manual Order"]})}),(0,b.jsxs)(g.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(g.DialogHeader,{children:(0,b.jsx)(g.DialogTitle,{children:"Create Manual Order"})}),(0,b.jsxs)("form",{onSubmit:F,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Customer (Optional)"}),(0,b.jsxs)(j.Select,{value:A.customerId,onValueChange:a=>B({...A,customerId:a}),children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select or leave empty for guest"})}),(0,b.jsx)(j.SelectContent,{children:q.map(a=>(0,b.jsxs)(j.SelectItem,{value:a._id,children:[a.firstName," ",a.lastName]},a._id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)(i.Label,{children:"Order Items"}),(0,b.jsxs)(d.Button,{type:"button",variant:"ghost",size:"sm",onClick:function(){B({...A,items:[...A.items,{productId:"",name:"",quantity:1,price:0}]})},children:[(0,b.jsx)(n.Plus,{className:"h-3 w-3 mr-1"}),"Add"]})]}),A.items.map((a,c)=>(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 items-end",children:[(0,b.jsx)("div",{className:"col-span-5",children:(0,b.jsxs)(j.Select,{value:a.productId,onValueChange:a=>G(c,"productId",a),children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Product"})}),(0,b.jsx)(j.SelectContent,{children:s.map(a=>(0,b.jsx)(j.SelectItem,{value:a._id,children:a.name},a._id))})]})}),(0,b.jsx)("div",{className:"col-span-2",children:(0,b.jsx)(h.Input,{type:"number",placeholder:"Qty",value:a.quantity,onChange:a=>G(c,"quantity",parseInt(a.target.value))})}),(0,b.jsx)("div",{className:"col-span-3",children:(0,b.jsx)(h.Input,{type:"number",placeholder:"Price",value:a.price,onChange:a=>G(c,"price",parseFloat(a.target.value))})}),(0,b.jsx)("div",{className:"col-span-2",children:A.items.length>1&&(0,b.jsx)(d.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>{B({...A,items:A.items.filter((a,b)=>b!==c)})},children:(0,b.jsx)(o.X,{className:"h-4 w-4"})})})]},c))]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Shipping Address"}),(0,b.jsx)(h.Input,{placeholder:"Street",value:A.shippingAddress.street,onChange:a=>B({...A,shippingAddress:{...A.shippingAddress,street:a.target.value}})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsx)(h.Input,{placeholder:"City",value:A.shippingAddress.city,onChange:a=>B({...A,shippingAddress:{...A.shippingAddress,city:a.target.value}})}),(0,b.jsx)(h.Input,{placeholder:"Country",value:A.shippingAddress.country,onChange:a=>B({...A,shippingAddress:{...A.shippingAddress,country:a.target.value}})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Order Status"}),(0,b.jsxs)(j.Select,{value:A.status,onValueChange:a=>B({...A,status:a}),children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(j.SelectItem,{value:"processing",children:"Processing"}),(0,b.jsx)(j.SelectItem,{value:"shipped",children:"Shipped"}),(0,b.jsx)(j.SelectItem,{value:"delivered",children:"Delivered"}),(0,b.jsx)(j.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Payment Status"}),(0,b.jsxs)(j.Select,{value:A.paymentStatus,onValueChange:a=>B({...A,paymentStatus:a}),children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(j.SelectItem,{value:"paid",children:"Paid"}),(0,b.jsx)(j.SelectItem,{value:"failed",children:"Failed"}),(0,b.jsx)(j.SelectItem,{value:"refunded",children:"Refunded"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Notes"}),(0,b.jsx)(l.Textarea,{value:A.notes,onChange:a=>B({...A,notes:a.target.value})})]}),(0,b.jsx)(d.Button,{type:"submit",className:"w-full",children:"Create Order"})]})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"All Orders"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)(f.Table,{children:[(0,b.jsx)(f.TableHeader,{children:(0,b.jsxs)(f.TableRow,{children:[(0,b.jsx)(f.TableHead,{children:"Order #"}),(0,b.jsx)(f.TableHead,{children:"Customer"}),(0,b.jsx)(f.TableHead,{children:"Date"}),(0,b.jsx)(f.TableHead,{children:"Status"}),(0,b.jsx)(f.TableHead,{children:"Payment"}),(0,b.jsx)(f.TableHead,{className:"text-right",children:"Total"}),(0,b.jsx)(f.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(f.TableBody,{children:a.map(a=>(0,b.jsxs)(f.TableRow,{children:[(0,b.jsx)(f.TableCell,{className:"font-medium",children:a.orderNumber}),(0,b.jsx)(f.TableCell,{children:a.customer?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{children:[a.customer.firstName," ",a.customer.lastName]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.customer.email})]}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"Guest"})}),(0,b.jsx)(f.TableCell,{children:new Date(a.createdAt).toLocaleDateString()}),(0,b.jsx)(f.TableCell,{children:(0,b.jsx)(k.Badge,{variant:function(a){switch(a){case"pending":default:return"secondary";case"processing":case"shipped":return"default";case"delivered":return"outline";case"cancelled":return"destructive"}}(a.status),children:a.status})}),(0,b.jsx)(f.TableCell,{children:a.paymentStatus}),(0,b.jsxs)(f.TableCell,{className:"text-right font-medium",children:["SAR ",a.total?.toFixed(2)]}),(0,b.jsx)(f.TableCell,{className:"text-right",children:(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",onClick:()=>{z(a),x(!0)},children:(0,b.jsx)(m.Eye,{className:"h-4 w-4"})})})]},a._id))})]})})]}),(0,b.jsx)(g.Dialog,{open:w,onOpenChange:x,children:(0,b.jsxs)(g.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(g.DialogHeader,{children:(0,b.jsx)(g.DialogTitle,{children:"Order Details"})}),y&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Order Number"}),(0,b.jsx)("p",{className:"font-medium",children:y.orderNumber})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Date"}),(0,b.jsx)("p",{children:new Date(y.createdAt).toLocaleString()})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 border-t pt-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Order Status"}),(0,b.jsxs)(j.Select,{value:y.status,onValueChange:async a=>{z({...y,status:a}),await fetch("/api/orders",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:y._id,status:a})}),C()},children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(j.SelectItem,{value:"processing",children:"Processing"}),(0,b.jsx)(j.SelectItem,{value:"shipped",children:"Shipped"}),(0,b.jsx)(j.SelectItem,{value:"delivered",children:"Delivered"}),(0,b.jsx)(j.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Payment Status"}),(0,b.jsxs)(j.Select,{value:y.paymentStatus,onValueChange:async a=>{z({...y,paymentStatus:a}),await fetch("/api/orders",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:y._id,paymentStatus:a})}),C()},children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(j.SelectItem,{value:"paid",children:"Paid"}),(0,b.jsx)(j.SelectItem,{value:"failed",children:"Failed"}),(0,b.jsx)(j.SelectItem,{value:"refunded",children:"Refunded"})]})]})]})]}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"font-semibold mb-2",children:"Items"}),(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("th",{className:"py-2 w-12"}),(0,b.jsx)("th",{className:"text-left py-2",children:"Product"}),(0,b.jsx)("th",{className:"text-center py-2",children:"Qty"}),(0,b.jsx)("th",{className:"text-right py-2",children:"Price"}),(0,b.jsx)("th",{className:"text-right py-2",children:"Total"})]})}),(0,b.jsx)("tbody",{children:y.items?.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("td",{className:"py-2",children:a.image?(0,b.jsx)("img",{src:a.image,alt:"",className:"w-10 h-10 object-cover rounded bg-gray-100"}):(0,b.jsx)("div",{className:"w-10 h-10 bg-gray-100 rounded flex items-center justify-center text-xs text-gray-400",children:"IMG"})}),(0,b.jsx)("td",{className:"py-2",children:a.name}),(0,b.jsx)("td",{className:"text-center py-2",children:a.quantity}),(0,b.jsxs)("td",{className:"text-right py-2",children:["SAR ",a.price]}),(0,b.jsxs)("td",{className:"text-right py-2",children:["SAR ",a.total]})]},c))})]})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-sm",children:["Subtotal: SAR ",y.subtotal]}),(0,b.jsxs)("p",{className:"text-sm",children:["Shipping: SAR ",y.shippingCost]}),(0,b.jsxs)("p",{className:"text-lg font-bold",children:["Total: SAR ",y.total]})]})}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"font-semibold mb-2",children:"Shipping Address"}),(0,b.jsx)("p",{children:y.shippingAddress?.street}),(0,b.jsxs)("p",{children:[y.shippingAddress?.city,", ",y.shippingAddress?.country]})]}),y.notes&&(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h4",{className:"font-semibold mb-2",children:"Notes"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:y.notes})]})]})]})})]})}a.s(["default",()=>p])}];

//# sourceMappingURL=app_orders_page_tsx_118043b9._.js.map